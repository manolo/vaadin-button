<!--
@license
Copyright (c) 2017 Vaadin Ltd.
This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
-->

<!--
`<vaadin-button>` is a Polymer element for customized buttons.

```html
<vaadin-button>
</vaadin-button>
```

@element vaadin-button
@demo demo/index.html
-->

<link rel="import" href="../polymer/polymer.html">

<dom-module id="vaadin-button">
  <template>
    <style>
      :host {
        display: inline-block;
        position: relative;
      }

      button {
        width: 100%;
        height: 100%;
        align-items: flex-start;
        background: linear-gradient(to bottom right, #fff, #eee);
        border: 1px solid #999;
        border-radius: 2px;
        box-sizing: border-box;
        cursor: default;
        font-size: 15px;
        letter-spacing: normal;
        margin: 0;
        padding: 2px 8px;
        text-align: center;
        text-indent: 0;
        text-rendering: auto;
        text-shadow: none;
        text-transform: none;
        word-spacing: normal;
        user-select: none;
      }

      button:hover {
        border-color: #666;
      }

      button:disabled {
        color: #aaa !important;
        background: #eee !important;
        border-color: #aaa !important;
        pointer-events: none;
      }

      button:active {
        background: linear-gradient(to bottom right, #eee, #fff);
      }
     </style>

    </style>
    <button id="button"
      autofocus$="[[autofocus]]"
      disabled$="[[disabled]]"
      name="[[name]]"
      value="[[value]]"
      tabindex$="[[tabindex]]"
      on-focus="_onButtonFocus"
      on-blur="_onButtonBlur"
      on-keydown="_onButtonKeyDown">
      <slot></slot>
    </button>
  </template>

  <script>
    class VaadinButton extends Polymer.Element {
      static get is() {
        return 'vaadin-button';
      }

      static get config() {
        return {
          properties: {
            /**
             * Indicates that this control is not available for interaction.
             */
            disabled: {
              type: Boolean,
              reflectToAttribute: true,
              observer: '_disabledChanged'
            },

            /**
             *
             */
            tabindex: {
              type: Number,
              value: 0,
              reflectToAttribute: true,
              observer: '_tabindexChanged'
            },

            /**
             * If true, the element currently has focus.
             */
            focused: {
              type: Boolean,
              notify: true,
              readOnly: true,
              reflectToAttribute: true
            }
          }
        };
      }

      ready() {
        super.ready();
        if (this.autofocus) {
          this.focus();
        }
        this.addEventListener('focus', this._focus.bind(this));
        this.addEventListener('blur', this._blur.bind(this));
      }

      _onButtonFocus() {
        this._setFocused(true);
      }

      _focus() {
        if (this.disabled) {
          this.blur();
        } else {
          this.$.button.focus();
        }
      }

      _onButtonBlur() {
        this._setFocused(false);
      }

      _blur() {
        this.$.button.blur();
      }

      _onButtonKeyDown(e) {
        // on shift-tab
        if (e.shiftKey && e.keyCode === 9) {
          this.focus();
        }
      }

      _disabledChanged(disabled) {
        if (disabled) {
          this._oldTabindex = this.tabindex;
          this.tabindex = -1;
        } else if (!disabled) {
          this.tabindex = this._oldTabindex || 0;
          this._oldTabindex = undefined;
        }
      }

      _tabindexChanged(tabindex) {
        if (this.disabled && tabindex != -1) {
          this._oldTabindex = tabindex;
        }
      }
    }

    customElements.define(VaadinButton.is, VaadinButton);
  </script>
</dom-module>
